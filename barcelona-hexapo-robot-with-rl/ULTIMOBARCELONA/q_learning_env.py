import math
import numpy as np
import random

class enviroment:
    def __init__(self):
        self.x = 139
        self.y = 139
        self.cont = 0
        self.x_position = 0
        self.y_position = 0
        self.x_old_state = 0
        self.y_old_state = 0
        self.goalx = self.x-1
        self.goaly = self.y-1
        self.action_space = [0,1,2,3]
        self.obstacles_map = [47, 48, 55, 78, 90, 91, 92, 93, 94, 95, 102, 108, 109, 110, 111, 121, 123, 135, 136, 173, 193, 201, 218, 228, 229, 230, 231, 232, 233, 235, 247, 248, 249, 259, 260, 263, 273, 274, 275, 311, 312, 329, 339, 340, 341, 344, 358, 366, 367, 368, 369, 370, 371, 373, 374, 375, 384, 385, 386, 387, 398, 403, 411, 412, 413, 415, 416, 454, 467, 468, 469, 478, 479, 482, 483, 504, 505, 506, 507, 508, 511, 512, 513, 514, 515, 522, 523, 524, 525, 535, 536, 543, 549, 550, 551, 553, 554, 555, 592, 593, 607, 618, 621, 644, 645, 646, 651, 652, 653, 654, 655, 662, 663, 673, 674, 675, 683, 689, 691, 692, 693, 694, 753, 754, 780, 784, 791, 792, 793, 794, 795, 811, 813, 814, 815, 829, 830, 831, 918, 919, 920, 931, 932, 935, 949, 950, 951, 953, 954, 955, 963, 969, 970, 1018, 1030, 1039, 1040, 1044, 1056, 1057, 1058, 1059, 1060, 1071, 1072, 1073, 1074, 1087, 1089, 1090, 1091, 1093, 1094, 1095, 1103, 1157, 1167, 1178, 1179, 1182, 1183, 1184, 1195, 1196, 1197, 1198, 1211, 1212, 1225, 1226, 1227, 1229, 1230, 1231, 1233, 1234, 1240, 1242, 1243, 1307, 1321, 1322, 1335, 1336, 1349, 1350, 1351, 1352, 1365, 1369, 1370, 1371, 1373, 1377, 1378, 1380, 1383, 1389, 1447, 1475, 1480, 1487, 1488, 1489, 1490, 1491, 1505, 1506, 1507, 1509, 1510, 1511, 1518, 1520, 1585, 1586, 1587, 1601, 1618, 1619, 1625, 1626, 1627, 1628, 1629, 1645, 1646, 1647, 1649, 1654, 1656, 1658, 1724, 1738, 1739, 1740, 1756, 1757, 1764, 1765, 1766, 1767, 1785, 1786, 1794, 1797, 1867, 1878, 1904, 1905, 1923, 1925, 1934, 1982, 1983, 2007, 2061, 2122, 2149, 2154, 2161, 2210, 2211, 2287, 2301, 2330, 2341, 2348, 2349, 2441, 2467, 2468, 2470, 2475, 2481, 2486, 2487, 2529, 2530, 2567, 2574, 2584, 2605, 2606, 2607, 2608, 2610, 2615, 2625, 2667, 2668, 2669, 2670, 2704, 2714, 2722, 2724, 2745, 2746, 2747, 2748, 2750, 2761, 2805, 2806, 2807, 2808, 2809, 2810, 2844, 2854, 2860, 2862, 2863, 2864, 2882, 2885, 2886, 2895, 2901, 2943, 2944, 2945, 2946, 2947, 2948, 2949, 2950, 2998, 3000, 3001, 3002, 3003, 3004, 3019, 3022, 3081, 3082, 3083, 3084, 3085, 3086, 3087, 3088, 3089, 3127, 3128, 3136, 3138, 3139, 3140, 3141, 3142, 3144, 3157, 3158, 3159, 3162, 3175, 3219, 3220, 3221, 3222, 3223, 3224, 3225, 3226, 3227, 3228, 3229, 3267, 3276, 3277, 3278, 3279, 3280, 3284, 3296, 3297, 3298, 3299, 3302, 3314, 3357, 3358, 3359, 3360, 3361, 3362, 3363, 3364, 3365, 3366, 3367, 3368, 3407, 3411, 3415, 3416, 3417, 3434, 3436, 3437, 3438, 3453, 3497, 3498, 3499, 3500, 3501, 3502, 3503, 3504, 3505, 3506, 3551, 3555, 3556, 3557, 3558, 3574, 3591, 3637, 3638, 3639, 3640, 3641, 3642, 3643, 3644, 3687, 3688, 3691, 3695, 3696, 3698, 3714, 3729, 3777, 3778, 3779, 3780, 3781, 3782, 3789, 3827, 3828, 3831, 3836, 3854, 3867, 3874, 3917, 3918, 3919, 3920, 3927, 3929, 3956, 3957, 3964, 3967, 3968, 3971, 3975, 3985, 3994, 4005, 4012, 4014, 4015, 4057, 4058, 4094, 4095, 4096, 4097, 4104, 4107, 4111, 4113, 4125, 4133, 4134, 4136, 4143, 4150, 4152, 4153, 4154, 4155, 4202, 4210, 4232, 4235, 4238, 4244, 4251, 4274, 4281, 4288, 4290, 4291, 4292, 4293, 4295, 4340, 4350, 4370, 4371, 4373, 4376, 4377, 4378, 4384, 4389, 4419, 4426, 4428, 4429, 4430, 4431, 4433, 4508, 4511, 4516, 4517, 4518, 4524, 4527, 4538, 4564, 4567, 4568, 4569, 4571, 4616, 4620, 4626, 4630, 4646, 4647, 4649, 4656, 4657, 4664, 4678, 4685, 4702, 4707, 4709, 4754, 4760, 4761, 4763, 4764, 4770, 4784, 4787, 4814, 4823, 4824, 4825, 4840, 4847, 4854, 4892, 4898, 4904, 4910, 4922, 4923, 4925, 4936, 4937, 4954, 4963, 4964, 4978, 4992, 4993, 4994, 4995, 5060, 5062, 5063, 5074, 5075, 5076, 5077, 5089, 5130, 5131, 5132, 5133, 5134, 5135, 5198, 5199, 5201, 5212, 5213, 5214, 5215, 5228, 5229, 5235, 5236, 5258, 5259, 5268, 5269, 5271, 5272, 5273, 5274, 5308, 5309, 5312, 5313, 5314, 5322, 5323, 5324, 5327, 5328, 5337, 5338, 5339, 5350, 5352, 5353, 5376, 5377, 5385, 5399, 5406, 5407, 5411, 5412, 5413, 5414, 5450, 5464, 5477, 5488, 5489, 5490, 5506, 5517, 5518, 5523, 5538, 5551, 5552, 5589, 5603, 5618, 5626, 5627, 5628, 5629, 5644, 5646, 5678, 5679, 5689, 5690, 5728, 5742, 5756, 5757, 5758, 5764, 5765, 5766, 5767, 5784, 5786, 5827, 5828, 5834, 5835, 5858, 5860, 5861, 5862, 5886, 5887, 5888, 5889, 5890, 5896, 5897, 5898, 5902, 5904, 5905, 5924, 5925, 5959, 5966, 5974, 5975, 5997, 5998, 6000, 6001, 6024, 6025, 6028, 6029, 6030, 6036, 6037, 6040, 6041, 6042, 6056, 6057, 6065, 6075, 6098, 6110, 6111, 6112, 6114, 6115, 6134, 6135, 6139, 6141, 6142, 6168, 6169, 6170, 6178, 6179, 6180, 6181, 6194, 6195, 6196, 6197, 6205, 6213, 6238, 6239, 6248, 6250, 6251, 6252, 6254, 6273, 6274, 6275, 6276, 6279, 6280, 6281, 6288, 6289, 6293, 6294, 6307, 6308, 6309, 6310, 6317, 6318, 6319, 6332, 6333, 6334, 6335, 6345, 6351, 6379, 6388, 6390, 6391, 6392, 6414, 6415, 6417, 6420, 6421, 6422, 6428, 6432, 6445, 6448, 6449, 6450, 6457, 6470, 6471, 6472, 6473, 6477, 6478, 6485, 6486, 6488, 6489, 6518, 6528, 6530, 6536, 6553, 6555, 6556, 6557, 6559, 6560, 6562, 6576, 6583, 6588, 6589, 6590, 6608, 6609, 6610, 6611, 6615, 6616, 6617, 6618, 6624, 6668, 6673, 6686, 6687, 6695, 6696, 6697, 6698, 6700, 6701, 6714, 6715, 6728, 6729, 6730, 6746, 6747, 6748, 6749, 6755, 6756, 6757, 6800, 6812, 6813, 6824, 6826, 6827, 6835, 6836, 6838, 6839, 6840, 6841, 6842, 6853, 6866, 6867, 6868, 6869, 6870, 6884, 6885, 6886, 6887, 6895, 6940, 6952, 6953, 6963, 6964, 6965, 6966, 6967, 6976, 6977, 6979, 6980, 6981, 6991, 6992, 7004, 7007, 7008, 7009, 7022, 7023, 7024, 7025, 7037, 7080, 7092, 7093, 7101, 7104, 7105, 7115, 7116, 7119, 7120, 7121, 7130, 7131, 7135, 7147, 7148, 7160, 7161, 7162, 7163, 7175, 7176, 7177, 7214, 7220, 7227, 7232, 7240, 7245, 7255, 7256, 7257, 7258, 7259, 7260, 7270, 7271, 7273, 7286, 7287, 7298, 7299, 7300, 7301, 7313, 7314, 7315, 7316, 7353, 7354, 7365, 7366, 7380, 7381, 7383, 7384, 7385, 7394, 7395, 7397, 7398, 7410, 7411, 7412, 7424, 7425, 7437, 7438, 7439, 7451, 7452, 7453, 7454, 7464, 7465, 7493, 7494, 7503, 7504, 7505, 7519, 7521, 7523, 7524, 7525, 7533, 7535, 7536, 7550, 7551, 7556, 7563, 7577, 7589, 7590, 7591, 7592, 7604, 7605, 7633, 7634, 7641, 7642, 7643, 7644, 7659, 7660, 7661, 7663, 7664, 7666, 7673, 7674, 7690, 7691, 7694, 7719, 7727, 7728, 7729, 7730, 7744, 7745, 7751, 7779, 7780, 7781, 7782, 7783, 7790, 7791, 7792, 7800, 7801, 7804, 7805, 7807, 7818, 7820, 7830, 7831, 7832, 7857, 7858, 7859, 7865, 7866, 7867, 7868, 7878, 7884, 7885, 7888, 7889, 7917, 7918, 7919, 7920, 7921, 7928, 7929, 7932, 7933, 7939, 7940, 7942, 7943, 7944, 7945, 7946, 7947, 7957, 7958, 7960, 7961, 7970, 7971, 7976, 7989, 7996, 7997, 7998, 7999, 8003, 8004, 8005, 8006, 8013, 8014, 8015, 8016, 8017, 8018, 8026, 8027, 8028, 8029, 8045, 8055, 8056, 8057, 8058, 8059, 8066, 8068, 8070, 8071, 8073, 8080, 8081, 8084, 8085, 8087, 8094, 8095, 8097, 8099, 8100, 8101, 8102, 8110, 8111, 8112, 8113, 8114, 8115, 8127, 8128, 8136, 8137, 8141, 8142, 8143, 8144, 8151, 8152, 8153, 8154, 8155, 8156, 8157, 8158, 8164, 8165, 8166, 8167, 8168, 8169, 8183, 8184, 8185, 8194, 8195, 8196, 8197, 8205, 8206, 8207, 8211, 8212, 8213, 8219, 8220, 8221, 8222, 8223, 8224, 8226, 8233, 8234, 8236, 8238, 8239, 8240, 8241, 8250, 8251, 8252, 8253, 8265, 8266, 8279, 8280, 8281, 8282, 8289, 8290, 8291, 8292, 8293, 8294, 8295, 8296, 8297, 8298, 8304, 8305, 8306, 8307, 8308, 8309, 8320, 8323, 8325, 8333, 8334, 8335, 8345, 8346, 8347, 8349, 8351, 8352, 8353, 8359, 8360, 8361, 8363, 8364, 8374, 8375, 8376, 8377, 8379, 8380, 8381, 8403, 8404, 8417, 8418, 8419, 8420, 8427, 8428, 8429, 8430, 8431, 8434, 8435, 8436, 8437, 8438, 8444, 8445, 8446, 8447, 8448, 8449, 8457, 8460, 8463, 8465, 8473, 8485, 8487, 8488, 8489, 8491, 8492, 8499, 8500, 8501, 8513, 8514, 8515, 8516, 8517, 8519, 8520, 8541, 8542, 8548, 8549, 8557, 8558, 8565, 8566, 8567, 8568, 8569, 8574, 8575, 8576, 8577, 8578, 8584, 8585, 8586, 8587, 8588, 8595, 8603, 8618, 8619, 8627, 8628, 8629, 8632, 8633, 8646, 8647, 8655, 8657, 8660, 8661, 8679, 8680, 8686, 8687, 8703, 8704, 8705, 8706, 8707, 8714, 8715, 8716, 8717, 8718, 8724, 8725, 8726, 8739, 8745, 8758, 8759, 8767, 8768, 8771, 8772, 8773, 8784, 8786, 8795, 8796, 8799, 8800, 8801, 8817, 8818, 8820, 8824, 8825, 8841, 8842, 8843, 8844, 8845, 8854, 8855, 8856, 8857, 8858, 8870, 8871, 8879, 8883, 8884, 8885, 8896, 8897, 8898, 8899, 8908, 8909, 8911, 8912, 8913, 8923, 8924, 8926, 8927, 8936, 8937, 8939, 8940, 8941, 8955, 8956, 8960, 8962, 8963, 8979, 8980, 8981, 8982, 8983, 8994, 8995, 8996, 8997, 8998, 9008, 9009, 9010, 9017, 9018, 9021, 9022, 9025, 9035, 9036, 9037, 9047, 9048, 9050, 9051, 9061, 9063, 9065, 9066, 9075, 9076, 9078, 9079, 9081, 9093, 9094, 9100, 9101, 9118, 9119, 9120, 9121, 9134, 9135, 9136, 9137, 9146, 9147, 9148, 9155, 9156, 9159, 9160, 9162, 9163, 9174, 9177, 9187, 9188, 9189, 9191, 9200, 9204, 9205, 9216, 9219, 9231, 9232, 9238, 9239, 9240, 9257, 9258, 9259, 9274, 9275, 9276, 9285, 9286, 9294, 9297, 9298, 9301, 9313, 9315, 9316, 9317, 9325, 9326, 9327, 9329, 9330, 9340, 9341, 9343, 9344, 9345, 9354, 9355, 9376, 9377, 9380, 9396, 9397, 9398, 9399, 9412, 9413, 9414, 9415, 9424, 9425, 9426, 9435, 9436, 9438, 9439, 9453, 9455, 9456, 9457, 9465, 9468, 9479, 9480, 9481, 9483, 9485, 9493, 9495, 9514, 9515, 9520, 9536, 9537, 9538, 9539, 9550, 9551, 9552, 9553, 9554, 9564, 9565, 9574, 9575, 9577, 9591, 9592, 9595, 9596, 9605, 9606, 9619, 9620, 9621, 9623, 9624, 9633, 9652, 9653, 9660, 9669, 9670, 9676, 9677, 9678, 9679, 9688, 9689, 9690, 9691, 9692, 9704, 9705, 9714, 9715, 9731, 9732, 9733, 9736, 9737, 9739, 9750, 9751, 9752, 9753, 9759, 9761, 9764, 9765, 9790, 9791, 9807, 9808, 9816, 9817, 9818, 9819, 9826, 9827, 9828, 9829, 9830, 9844, 9845, 9871, 9872, 9875, 9876, 9877, 9878, 9879, 9888, 9889, 9890, 9891, 9892, 9893, 9899, 9900, 9903, 9904, 9906, 9907, 9945, 9948, 9949, 9956, 9957, 9958, 9959, 9964, 9965, 9966, 9967, 9968, 9978, 9984, 9985, 10012, 10013, 10017, 10019, 10026, 10027, 10028, 10029, 10030, 10031, 10032, 10033, 10040, 10041, 10044, 10045, 10047, 10057, 10083, 10084, 10085, 10086, 10087, 10089, 10096, 10097, 10098, 10099, 10102, 10103, 10104, 10105, 10106, 10116, 10117, 10118, 10125, 10151, 10152, 10153, 10154, 10156, 10158, 10165, 10166, 10167, 10168, 10169, 10170, 10171, 10172, 10173, 10179, 10180, 10182, 10185, 10195, 10196, 10197, 10201, 10221, 10222, 10223, 10224, 10225, 10227, 10236, 10237, 10238, 10239, 10240, 10241, 10242, 10243, 10244, 10251, 10254, 10255, 10256, 10257, 10258, 10264, 10291, 10292, 10293, 10295, 10296, 10305, 10306, 10307, 10308, 10309, 10310, 10311, 10320, 10321, 10333, 10334, 10335, 10336, 10337, 10339, 10341, 10359, 10360, 10361, 10362, 10363, 10364, 10376, 10377, 10378, 10379, 10380, 10381, 10382, 10391, 10392, 10393, 10394, 10395, 10396, 10397, 10431, 10433, 10445, 10446, 10447, 10448, 10449, 10452, 10453, 10459, 10461, 10474, 10475, 10476, 10477, 10478, 10479, 10481, 10497, 10498, 10499, 10500, 10501, 10502, 10503, 10509, 10516, 10517, 10518, 10519, 10520, 10531, 10532, 10533, 10534, 10535, 10564, 10565, 10578, 10579, 10587, 10590, 10591, 10592, 10593, 10599, 10614, 10615, 10616, 10618, 10619, 10621, 10635, 10636, 10637, 10638, 10640, 10641, 10643, 10644, 10649, 10671, 10672, 10673, 10677, 10678, 10704, 10705, 10716, 10717, 10718, 10719, 10728, 10729, 10730, 10731, 10732, 10733, 10754, 10755, 10756, 10757, 10758, 10759, 10774, 10776, 10777, 10778, 10781, 10782, 10783, 10789, 10802, 10811, 10815, 10816, 10817, 10818, 10854, 10855, 10856, 10857, 10858, 10859, 10867, 10868, 10869, 10870, 10871, 10872, 10894, 10914, 10916, 10917, 10918, 10919, 10920, 10921, 10923, 10942, 10953, 10954, 10955, 10956, 10957, 10982, 10983, 10993, 10994, 10995, 10996, 10997, 10998, 11007, 11008, 11009, 11010, 11011, 11023, 11035, 11054, 11056, 11057, 11058, 11059, 11061, 11062, 11063, 11081, 11082, 11091, 11092, 11093, 11094, 11095, 11121, 11122, 11123, 11132, 11133, 11134, 11135, 11136, 11137, 11147, 11148, 11149, 11150, 11161, 11162, 11163, 11173, 11194, 11196, 11197, 11199, 11200, 11201, 11202, 11203, 11209, 11220, 11221, 11222, 11229, 11230, 11231, 11232, 11233, 11261, 11271, 11272, 11273, 11274, 11275, 11276, 11277, 11285, 11286, 11287, 11288, 11289, 11299, 11301, 11302, 11303, 11311, 11320, 11321, 11326, 11327, 11334, 11337, 11338, 11339, 11340, 11341, 11342, 11347, 11348, 11358, 11359, 11360, 11361, 11362, 11367, 11368, 11369, 11370, 11371, 11398, 11411, 11412, 11413, 11414, 11415, 11416, 11417, 11425, 11426, 11427, 11439, 11441, 11442, 11443, 11449, 11458, 11460, 11461, 11464, 11465, 11466, 11467, 11475, 11476, 11477, 11478, 11479, 11480, 11485, 11486, 11496, 11497, 11498, 11499, 11500, 11501, 11505, 11506, 11507, 11508, 11509, 11537, 11538, 11551, 11552, 11553, 11554, 11555, 11556, 11557, 11565, 11579, 11581, 11582, 11583, 11587, 11596, 11598, 11599, 11600, 11605, 11606, 11607, 11614, 11615, 11616, 11617, 11618, 11635, 11636, 11637, 11638, 11639, 11643, 11644, 11645, 11646, 11647, 11676, 11683, 11684, 11685, 11691, 11692, 11693, 11694, 11695, 11696, 11697, 11713, 11719, 11721, 11722, 11723, 11725, 11734, 11735, 11738, 11739, 11740, 11746, 11747, 11754, 11755, 11756, 11775, 11776, 11777, 11781, 11782, 11783, 11784, 11785, 11820, 11821, 11822, 11823, 11824, 11825, 11831, 11832, 11833, 11834, 11835, 11836, 11837, 11838, 11839, 11851, 11859, 11861, 11862, 11863, 11872, 11873, 11877, 11878, 11879, 11885, 11886, 11887, 11894, 11915, 11919, 11920, 11921, 11922, 11923, 11953, 11958, 11959, 11960, 11961, 11962, 11963, 11964, 11965, 11971, 11972, 11973, 11974, 11975, 11976, 11977, 11978, 11979, 11989, 11993, 11999, 12001, 12010, 12011, 12017, 12018, 12019, 12025, 12057, 12058, 12059, 12060, 12061, 12084, 12085, 12090, 12091, 12092, 12096, 12097, 12098, 12099, 12100, 12101, 12102, 12103, 12104, 12105, 12111, 12112, 12113, 12114, 12115, 12116, 12117, 12127, 12133, 12139, 12148, 12149, 12157, 12158, 12182, 12196, 12197, 12198, 12199, 12223, 12224, 12225, 12229, 12230, 12231, 12234, 12235, 12236, 12237, 12238, 12241, 12242, 12243, 12244, 12245, 12251, 12252, 12253, 12254, 12255, 12265, 12273, 12286, 12298, 12299, 12320, 12335, 12336, 12337, 12360, 12361, 12363, 12372, 12373, 12374, 12375, 12376, 12381, 12382, 12383, 12384, 12385, 12391, 12392, 12393, 12413, 12424, 12433, 12434, 12437, 12438, 12458, 12475, 12498, 12500, 12501, 12510, 12511, 12512, 12513, 12514, 12521, 12522, 12523, 12524, 12525, 12550, 12551, 12553, 12562, 12573, 12574, 12596, 12636, 12637, 12638, 12649, 12650, 12651, 12652, 12661, 12662, 12663, 12664, 12665, 12688, 12690, 12691, 12700, 12709, 12710, 12713, 12714, 12774, 12775, 12776, 12777, 12788, 12789, 12790, 12801, 12802, 12803, 12804, 12828, 12848, 12849, 12872, 12913, 12914, 12915, 12920, 12927, 12928, 12941, 12942, 12943, 12957, 12961, 12985, 13050, 13051, 13053, 13059, 13060, 13066, 13079, 13080, 13081, 13082, 13095, 13096, 13101, 13125, 13188, 13190, 13191, 13199, 13200, 13205, 13206, 13207, 13217, 13218, 13219, 13220, 13221, 13233, 13234, 13241, 13265, 13326, 13327, 13328, 13339, 13340, 13344, 13345, 13346, 13347, 13355, 13356, 13357, 13358, 13359, 13371, 13372, 13381, 13405, 13464, 13465, 13466, 13467, 13472, 13473, 13479, 13483, 13484, 13485, 13486, 13487, 13493, 13494, 13495, 13496, 13497, 13530, 13536, 13602, 13603, 13604, 13605, 13612, 13613, 13623, 13624, 13625, 13626, 13627, 13631, 13632, 13633, 13634, 13635, 13668, 13676, 13700, 13740, 13741, 13742, 13743, 13752, 13753, 13763, 13764, 13765, 13766, 13767, 13769, 13770, 13771, 13772, 13773, 13783, 13787, 13788, 13806, 13816, 13838, 13840, 13879, 13880, 13881, 13892, 13893, 13903, 13904, 13905, 13906, 13907, 13908, 13909, 13910, 13911, 13921, 13927, 13928, 13944, 13956, 13976, 13977, 13980, 14016, 14017, 14019, 14024, 14025, 14043, 14044, 14045, 14046, 14047, 14048, 14049, 14059, 14067, 14068, 14090, 14115, 14116, 14117, 14120, 14154, 14155, 14156, 14157, 14164, 14165, 14183, 14184, 14185, 14186, 14187, 14197, 14207, 14208, 14217, 14218, 14228, 14232, 14245, 14253, 14255, 14256, 14257, 14260, 14292, 14293, 14294, 14295, 14304, 14305, 14323, 14324, 14325, 14335, 14347, 14355, 14356, 14358, 14363, 14366, 14371, 14385, 14393, 14395, 14396, 14397, 14431, 14432, 14433, 14444, 14445, 14473, 14474, 14493, 14494, 14496, 14502, 14503, 14509, 14525, 14535, 14536, 14537, 14539, 14540, 14571, 14611, 14612, 14613, 14614, 14620, 14621, 14632, 14634, 14642, 14643, 14665, 14672, 14675, 14678, 14679, 14680, 14749, 14750, 14751, 14752, 14753, 14754, 14758, 14759, 14760, 14761, 14771, 14778, 14782, 14783, 14810, 14817, 14818, 14819, 14820, 14873, 14888, 14889, 14890, 14891, 14892, 14893, 14894, 14896, 14897, 14898, 14899, 14910, 14911, 14918, 14922, 14948, 14955, 14957, 14958, 14959, 15013, 15028, 15029, 15030, 15031, 15032, 15033, 15034, 15035, 15036, 15037, 15050, 15051, 15058, 15086, 15091, 15094, 15095, 15097, 15151, 15152, 15168, 15169, 15170, 15171, 15172, 15173, 15174, 15175, 15190, 15191, 15198, 15224, 15229, 15230, 15231, 15232, 15233, 15234, 15235, 15290, 15307, 15308, 15309, 15310, 15311, 15312, 15313, 15330, 15367, 15368, 15369, 15370, 15371, 15372, 15373, 15429, 15443, 15445, 15446, 15447, 15448, 15449, 15450, 15451, 15461, 15484, 15487, 15505, 15507, 15508, 15509, 15510, 15511, 15583, 15584, 15585, 15586, 15587, 15588, 15589, 15597, 15598, 15599, 15601, 15622, 15627, 15643, 15644, 15645, 15647, 15648, 15649, 15723, 15724, 15725, 15726, 15727, 15736, 15737, 15738, 15739, 15760, 15767, 15783, 15784, 15785, 15787, 15863, 15864, 15865, 15874, 15876, 15877, 15883, 15884, 15898, 15907, 15923, 15924, 15925, 15994, 15995, 16003, 16012, 16021, 16022, 16024, 16030, 16036, 16062, 16063, 16132, 16133, 16150, 16151, 16154, 16159, 16160, 16162, 16164, 16170, 16174, 16200, 16267, 16270, 16271, 16290, 16291, 16294, 16297, 16298, 16300, 16302, 16303, 16310, 16328, 16338, 16339, 16405, 16409, 16430, 16431, 16434, 16436, 16438, 16440, 16441, 16444, 16466, 16467, 16476, 16477, 16500, 16543, 16544, 16570, 16571, 16574, 16577, 16579, 16584, 16604, 16605, 16608, 16614, 16638, 16639, 16640, 16650, 16681, 16683, 16684, 16710, 16711, 16712, 16717, 16724, 16742, 16743, 16745, 16748, 16752, 16753, 16776, 16777, 16778, 16779, 16788, 16789, 16790, 16850, 16880, 16881, 16883, 16887, 16888, 16890, 16891, 16914, 16915, 16916, 16917, 16928, 16929, 16988, 17018, 17019, 17021, 17025, 17026, 17027, 17028, 17052, 17053, 17054, 17055, 17126, 17156, 17157, 17159, 17161, 17163, 17164, 17165, 17166, 17167, 17190, 17191, 17192, 17193, 17264, 17281, 17294, 17295, 17299, 17301, 17303, 17304, 17305, 17328, 17329, 17330, 17331, 17389, 17403, 17419, 17420, 17430, 17432, 17433, 17435, 17436, 17439, 17440, 17443, 17466, 17467, 17468, 17469, 17527, 17528, 17529, 17543, 17557, 17558, 17571, 17573, 17574, 17575, 17577, 17578, 17579, 17580, 17581, 17604, 17605, 17606, 17607, 17665, 17666, 17667, 17683, 17695, 17696, 17702, 17703, 17704, 17710, 17711, 17712, 17713, 17716, 17717, 17718, 17719, 17742, 17743, 17744, 17745, 17805, 17833, 17834, 17840, 17841, 17842, 17843, 17844, 17850, 17851, 17853, 17854, 17856, 17857, 17880, 17881, 17882, 17883, 17971, 17972, 17978, 17979, 17980, 17981, 17982, 17983, 17984, 17991, 17993, 17994, 18018, 18019, 18020, 18021, 18088, 18103, 18109, 18110, 18116, 18117, 18118, 18119, 18120, 18121, 18122, 18123, 18124, 18130, 18131, 18133, 18156, 18157, 18158, 18159, 18226, 18227, 18228, 18243, 18247, 18248, 18254, 18255, 18256, 18257, 18258, 18259, 18260, 18261, 18262, 18263, 18264, 18270, 18271, 18294, 18295, 18296, 18297, 18366, 18383, 18385, 18386, 18392, 18393, 18394, 18395, 18396, 18397, 18398, 18399, 18400, 18401, 18402, 18403, 18404, 18432, 18433, 18434, 18435, 18487, 18524, 18530, 18531, 18532, 18533, 18534, 18535, 18536, 18537, 18538, 18539, 18540, 18541, 18542, 18543, 18544, 18570, 18571, 18572, 18573, 18626, 18627, 18640, 18641, 18649, 18652, 18668, 18669, 18670, 18671, 18672, 18673, 18674, 18675, 18676, 18677, 18678, 18679, 18680, 18681, 18682, 18708, 18709, 18710, 18711, 18765, 18766, 18767, 18806, 18807, 18808, 18809, 18810, 18811, 18812, 18813, 18814, 18815, 18816, 18817, 18818, 18819, 18820, 18846, 18847, 18848, 18849, 18904, 18905, 18906, 18907, 18945, 18946, 18947, 18948, 18949, 18950, 18951, 18952, 18953, 18954, 18955, 18956, 18957, 18958, 18984, 18985, 18986, 18987, 19043, 19044, 19045, 19046, 19066, 19084, 19085, 19086, 19087, 19088, 19089, 19090, 19091, 19092, 19093, 19094, 19095, 19096, 19122, 19123, 19124, 19125, 19182, 19183, 19184, 19185, 19195, 19201, 19204, 19209, 19210, 19223, 19224, 19225, 19226, 19227, 19228, 19229, 19230, 19231, 19232, 19233, 19234, 19260, 19261, 19262, 19263, 19283]
        self.states = np.zeros(self.x*self.x).tolist()
        self.actions_size = len(self.action_space)
        self.states_size = self.x*self.y
        self.state_matrix = np.ascontiguousarray(np.arange(self.states_size).reshape(self.y, self.x), dtype=int)
        self.matrix_list = self.state_matrix.tolist()

    def reset_enviroment(self):
        self.x_position = 0
        self.y_position = 0
        self.state = 0
        self.reward = 0
        return 0, 0, False

    def update_instructions_list(self,state, state_list):
        if state not in self.obstacles_map and state!=self.x_position:
            if self.states[state]==0:
                self.states[state] = len(state_list)
            else:
                if self.states[state]> len(state_list):
                    self.states[state] = len(state_list)

    def get_env_states(self):
        return self.states

    def next_step(self, action, state):
        old_x= self.x_position
        old_y= self.y_position
        if self.x_position==self.goalx and self.y_position==self.goaly:
            done=True
            reward = 5000
            obstacle = False
            return state, reward, done, obstacle
        else:
            # up
            if action==0 and self.x_position>0:
                self.x_position -= 1
            # Move left
            elif action== 1 and self.y_position>0:
                self.y_position-= 1
            # Move down
            elif action==2 and self.x_position<self.x-1:
                self.x_position+=1
            # Move right
            elif action==3 and self.y_position<self.y-1:
                self.y_position+=1
            obstacle = False
            reward=-1
            done=False
            next_state = self.state_matrix[self.x_position][self.y_position]
            if next_state in self.obstacles_map:
                reward = -500
                obstacle = True
                #print(old_x, old_y)
                #print(self.x_position, self.y_position)
                '''                self.x_position = old_x
                                self.y_position = old_y
                                #print('novos', self.x_position, self.y_position)
                                next_state=state'''
            return next_state, reward, done, obstacle

    def get_state_index(self):
        return self.x_position, self.y_position
    
    def insert_old_state_index(self, x, y):
        self.x_old_state = x
        self.y_old_state = y

    def get_goal_index(self):
        return self.goaly, self.goaly

    def select_random_action(self):
        return np.random.choice(self.action_space)
